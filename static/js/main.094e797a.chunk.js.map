{"version":3,"sources":["workers/Worker.js","Card.js","workers/WorkerPool.js","config.js","App.js","serviceWorker.js","index.js"],"names":["addMethods","methods","module","exports","w","Worker","name","synth","window","speechSynthesis","Card","workerFactory","size","details","utterThis","SpeechSynthesisUtterance","className","types","type","id","onClick","speak","map","src","WorkerPool","worker","this","i","poolSize","used","pool","jobs","hasOwnProperty","_method","args","_queueJob","method","Promise","y","n","push","_nextJob","pop","job","shift","then","catch","finally","P","require","Pokedex","workers","navigator","hardwareConcurrency","App","useState","pokemon","setPokemon","offset","setOffset","limit","pokemonData","setPokemonData","allPokemon","setAllPokemon","search","setSearch","useEffect","getPokemon","length","getPokemonData","getAllPokemon","workerFetch","list","slice","prevState","result","filter","index","includes","toLowerCase","toString","a","options","getPokemonsList","results","getPokemonByName","data","loadMore","fetch","Icon","Input","fluid","icon","iconPosition","placeholder","onChange","event","target","value","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","serviceWorker","ready","registration","unregister","error","console","message"],"mappings":"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","file":"static/js/main.094e797a.chunk.js","sourcesContent":["\n\t\t\t\tvar addMethods = require(\"../../node_modules/workerize-loader/dist/rpc-wrapper.js\")\n\t\t\t\tvar methods = [\"fetch\"]\n\t\t\t\tmodule.exports = function() {\n\t\t\t\t\tvar w = new Worker(__webpack_public_path__ + \"061e58ee5301f793355f.worker.js\", { name: \"[hash].worker.js\" })\n\t\t\t\t\taddMethods(w, methods)\n\t\t\t\t\t\n\t\t\t\t\treturn w\n\t\t\t\t}\n\t\t\t","import React from 'react';\nimport { IMG_DETAIL_URL } from './config'\nimport './Card.css'\n\nconst synth = window.speechSynthesis;\n\nfunction Card ({details}) {\n    const utterThis = new SpeechSynthesisUtterance(details.name);\n    return (\n        <div className={`card ${details.types[0].type.name}`}>\n            <div className=\"details\">\n                <div>\n                    <p className=\"id\">{`#${details.id}`}</p>\n                    <p className=\"name\" onClick={() => {synth.speak(utterThis);}}>{details.name}</p>\n                    <div className=\"types\">\n                        {details.types.map((type) => (\n                            <span className={`type ${type.type.name}`}>â¬¤</span>\n                        ))}\n                    </div>\n                </div>\n            </div>\n            {details.id >= 10000 ? null : <img className=\"img\" src={`${IMG_DETAIL_URL}/${details.id}.png`} />}\n        </div>\n    );\n}\n\nexport default Card;","export default (workerFactory, size) => new WorkerPool(workerFactory, size);\n\nclass WorkerPool {\n  constructor(workerFactory, size) {\n    let worker = (this.workerFactory = workerFactory)();\n    this.poolSize = size || 4;\n    this.used = 1;\n    this.pool = [worker];\n    this.jobs = [];\n    for (let i in worker) if (worker.hasOwnProperty(i) && typeof worker[i]==='function') {\n      this[i] = this._method(i);  // proxy all methods available on the worker\n    }\n  }\n  _method(name) {\n    return (...args) => this._queueJob(name, args);\n  }\n  _queueJob(method, args) {\n    return new Promise((y, n) => {\n      this.jobs.push({ method, args, y, n });\n      this._nextJob();\n    }) \n  }\n  _nextJob() {\n    let worker = this.pool.pop();\n    if (!worker) {\n      if (this.used >= this.poolSize) return;\n      this.used++;\n      worker = this.workerFactory();\n    }\n    const job = this.jobs.shift();\n    if (!job) return;\n    worker[job.method](...job.args).then(job.y).catch(job.n).finally(() => {\n      this.pool.push(worker);\n      this._nextJob();\n    });\n  }\n}","export const IMG_DETAIL_URL = 'https://raw.githubusercontent.com/cotyhamilton/pokemon/master/img/detail';\nexport const IMG_FULL_URL = 'https://raw.githubusercontent.com/cotyhamilton/pokemon/master/img/full';","import React, { useState, useEffect } from 'react';\nimport './App.css';\nimport Card from './Card';\nimport { Icon, Input } from 'semantic-ui-react';\nimport Worker from 'workerize-loader!./workers/Worker'; // eslint-disable-line import/no-webpack-loader-syntax\nimport WorkerPool from './workers/WorkerPool';\n\nconst Pokedex = require('pokeapi-js-wrapper');\nconst P = new Pokedex.Pokedex();\n\nlet workers = WorkerPool(Worker, navigator.hardwareConcurrency || 4);\n\nfunction App() {\n  const [pokemon, setPokemon] = useState([]);\n  const [offset, setOffset] = useState(0);\n  const [limit] = useState(50);\n  const [pokemonData, setPokemonData] = useState({});\n  const [allPokemon, setAllPokemon] = useState([]);\n  const [search, setSearch] = useState('');\n\n  useEffect(() => {\n    getPokemon();\n  }, [offset]);\n\n  useEffect(() => {\n    if (pokemon.length) {\n      pokemon.map((pokemon) => {\n        getPokemonData(pokemon.name);\n      })\n    }\n  }, [pokemon]);\n\n  useEffect(() => {\n    getAllPokemon();\n  }, []);\n\n  useEffect(() => {\n    if (allPokemon.length) {\n      allPokemon.map((pokemon) => (\n        workerFetch(pokemon)\n      ));\n    }\n  }, [allPokemon]);\n\n  useEffect(() => {\n    if (search === '') {\n      const list = allPokemon.slice(offset, offset + limit);\n      setPokemon((prevState) => ([...list]));\n    }\n    else {\n      const result = allPokemon.filter((pokemon, index) => (\n        pokemon.name.includes(search.toLowerCase()) || (index + 1).toString().includes(search)\n      ));\n      setPokemon((prevState) => ([...result]))\n    }\n  }, [search]);\n\n  const getPokemon = async () => {\n    if (allPokemon.length > offset + limit) {\n      const list = allPokemon.slice(offset, offset + limit);\n      setPokemon((prevState) => ([...prevState, ...list]));\n    }\n    else {\n      const options = { offset, limit };\n      const list = await P.getPokemonsList(options);\n      setPokemon((prevState) => ([...prevState, ...list.results]));\n    }\n  }\n\n  const getPokemonData = async (pokemon) => {\n    if (!pokemonData.pokemon) {\n      const data = await P.getPokemonByName(pokemon);\n      setPokemonData((prevState) => ({ ...prevState, [data.name]: data }))\n    }\n  }\n\n  const getAllPokemon = async () => {\n    const list = await P.getPokemonsList();\n    setAllPokemon([...list.results]);\n  }\n\n  const loadMore = async () => {\n    await setOffset(offset + limit);\n  }\n\n  const workerFetch = async (pokemon) => {\n    const data = await workers.fetch(pokemon);\n    setPokemonData((prevState) => ({ ...prevState, [data.name]: data }))\n  }\n\n  const handleChange = event => {\n    setSearch(event.target.value);\n  };\n\n  return (\n    <div className=\"App\">\n      <header>\n        <Icon className=\"icon\" name=\"sliders\" size=\"large\" />\n      </header>\n      <div className=\"home\">\n        <h1>PokÃ©dex</h1>\n        <p>Search for PokÃ©mon by name or using the National PokÃ©dex number</p>\n        <Input\n          fluid\n          icon=\"search\"\n          iconPosition=\"left\"\n          placeholder=\"What PokÃ©mon are you looking for?\"\n          onChange={handleChange}\n        />\n        {pokemon.length ? pokemon.map((pokemon, index) => (\n          !!pokemonData[pokemon.name] ?\n            <Card\n              details={!!pokemonData[pokemon.name] ? pokemonData[pokemon.name] : null}\n            /> : null\n        )) : null}\n      </div>\n      {search === '' ?\n        <div className=\"page-navigation\">\n          <span onClick={loadMore}>more</span>\n        </div>\n        : null}\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport 'semantic-ui-css/semantic.min.css'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}